{"version":3,"sources":["index.js"],"names":["MAX_ZOOM","INITIAL_ZOOM","LEGEND_Y_LINE_COUNT","MODE_NAMES","day","night","MIN_LEGEND_X_LABEL_WIDHT_PX","isFirefox","navigator","userAgent","toLowerCase","indexOf","currentId","createChart","parentElement","minY","columns","types","names","colors","xAxis","xAxisLength","yAxis","width","start","maxY","chartWidth","chartOffsetX","prevX","isAdjusting","eventType","refs","zoomedIndex","key","getByFirst","slice","length","push","d","c","n","a","allY","concat","map","line","getStartIndex","getEndIndex","getViewBoxXRange","getActiveYs","filter","getMaxSelectedY","Math","max","getSelectedY","ceil","getPreviewScale","getMaxActiveY","getLedendY","i","maxSelectedY","Infinity","shortNumber","floor","min","chartElement","legendX","referenceKey","create","l","mousemove","moveLens","touchmove","viewBox","preserveAspectRatio","r","bindReference","fill","СЃ","createPath","createDot","createLegendY","legend","unshift","textContent","createLegendX","date","getDateString","createTooltipValues","s","color","mousedown","beforeAdjust","touchstart","createSwitcher","click","direction","drawLinesAndSwitches","scalePreview","drawCharts","drawLegendY","backgroundColor","toggleLine","stroke","reduce","y","x","flag","onResize","setChartWidthAndOffset","moveLegendX","previewEl","offsetWidth","getBoundingClientRect","type","e","preventDefault","stopPropagation","getEventX","adjust","delta","nextStart","nextWidth","limit","movePreview","scaleLegendX","sign","afterAdjust","lensX","round","lensZoom","setAttribute","tooltipDate","lensPos","tooltipOffset","tooltip","style","transform","forEach","dot","pin","yValue","dd","switcher","lensPath","previewPath","tooltipValue","el","toggleClass","rangeEl","left","toFixed","setTransform","previewGroup","translateX","scaleX","scaleY","lensTranslateGroup","lensScaleXGroup","lensScaleYGroup","debounce","legendXWidth","labelsToSkipDivider","legendXLabels","label","MutationObserver","mutationCallback","mutationsList","observer","mutation","document","addEventListener","window","disconnect","observe","childList","appendChild","array","find","item","t","h","split","_t","createElementNS","createElement","classList","add","k","attr","Element","state","className","remove","targetTouches","clientX","value","target","bind","fn","delay","timeoutId","args","arguments","clearTimeout","setTimeout","apply","throttle","func","ms","isThrottled","savedArgs","savedThis","wrapper","Date","toString","weekday","month","replace","number","ctt","msg","count","console","time","timeEnd","body","fetch","then","response","json","charts","data","holder","isNight","documentElement"],"mappings":"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","file":"chartapp.33b97099.js","sourceRoot":"..","sourcesContent":["/* CONSTANTS */\nconst MAX_ZOOM = 0.05;\nconst INITIAL_ZOOM = 0.15;\nconst LEGEND_Y_LINE_COUNT = 6;\nconst MODE_NAMES = {\n  day: 'Switch to Night Mode',\n  night: 'Switch to Day Mode',\n};\nconst MIN_LEGEND_X_LABEL_WIDHT_PX = 120;\nconst isFirefox = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;\n\nlet currentId = 1;\n\nfunction createChart({ columns, types, names, colors }, parentElement) {\n  let xAxis = [];\n  let xAxisLength = 0;\n  let yAxis = [];\n  let width = INITIAL_ZOOM;\n  let start = 1 - width;\n  let maxY = 0;\n  let minY = 0;\n  let chartWidth = 0;\n  let chartOffsetX = 0;\n  let prevX = 0;\n  let isAdjusting = false;\n  let eventType = '';\n  let refs = {};\n  let zoomedIndex = 0;\n\n  for (const key in types) {\n    switch (types[key]) {\n      case 'x':\n        xAxis = getByFirst(columns, key).slice(1);\n        xAxisLength = xAxis.length - 1;\n        break;\n      case 'line':\n        yAxis.push({\n          d: getByFirst(columns, key).slice(1),\n          c: colors[key],\n          n: names[key],\n          a: true,\n        });\n        break;\n    }\n  }\n\n  const allY = [].concat(...yAxis.map(line => line.d));\n  maxY = Math.max(...allY);\n  minY = Math.min(...allY);\n\n  function getStartIndex() {\n    return xAxisLength * start;\n  }\n\n  function getEndIndex() {\n    return xAxisLength * (start + width);\n  }\n\n  function getViewBoxXRange() {\n    return getEndIndex() - getStartIndex();\n  }\n\n  function getActiveYs() {\n    return yAxis.filter(line => line.a);\n  }\n\n  function getSelectedY() {\n    return [].concat(...getActiveYs().map(line => line.d.slice(Math.ceil(getStartIndex()), Math.ceil(getEndIndex()))));\n  }\n\n  function getMaxActiveY() {\n    return Math.max(...[].concat(...getActiveYs().map(line => line.d)));\n  }\n\n  function getMaxSelectedY() {\n    return Math.max(...getSelectedY());\n  }\n\n  function getPreviewScale() {\n    return maxY / getMaxActiveY();\n  }\n\n  function getLensScale() {\n    return maxY / getMaxSelectedY();\n  }\n\n  function getLedendY(i) {\n    const maxSelectedY = getMaxSelectedY();\n    if (maxSelectedY === -Infinity) {\n      return '';\n    }\n    return shortNumber(Math.floor(maxSelectedY / LEGEND_Y_LINE_COUNT) * i);\n  }\n\n  // create DOM with hyperscript\n  const chartElement = create('section.chart', {}, [\n    [\n      'div.chart__body',\n      {},\n      [\n        [\n          'div.chart__details',\n          {\n            l: {\n              mousemove: moveLens,\n              touchmove: moveLens,\n            },\n          },\n          [\n            [\n              'svg.muting',\n              {\n                a: {\n                  viewBox: `0 0 ${xAxisLength} ${maxY}`,\n                  preserveAspectRatio: 'none',\n                },\n              },\n              [\n                [\n                  'g',\n                  { r: bindReference(refs, 'lensTranslateGroup') },\n                  [\n                    ['g',\n                    { r: bindReference(refs, 'lensScaleXGroup')},\n                    [\n                      ['g.chart__group',\n                      { r: bindReference(refs, 'lensScaleYGroup') },\n                      [\n                        [\n                          'path.chart__lens.lens',\n                          {\n                            a: { d: `M0 0L0 ${maxY}`, fill: 'none', 'vector-effect': 'non-scaling-stroke' },\n                            r: bindReference(refs, 'lensZoom'),\n                          },\n                        ],\n                        ...[].concat(...yAxis.map(createPathAndDots('lensPath'))),\n                      ],]\n                    ],]\n                  ],\n                ],\n              ],\n            ],\n          ],\n        ],\n        ['div.chart__legend-y', {}, [...createLegendY()]],\n        ['div.chart__legend-x', { r: bindReference(refs, 'legendX') }, [...createLegendX()]],\n        ['div.tooltip.lens', {r: bindReference(refs, 'tooltip')}, [\n          ['div.tooltip__date', { r: bindReference(refs, 'tooltipDate') }],\n          ['div.tooltip__set', {}, yAxis.map(createTooltipValues)],\n        ]],\n      ],\n    ],\n    [\n      'div.chart__preview',\n      { r: bindReference(refs, 'previewEl') },\n      [\n        [\n          'svg.muting',\n          {\n            a: {\n              viewBox: `0 0 ${xAxisLength} ${maxY - minY}`,\n              preserveAspectRatio: 'none',\n            },\n          },\n          [['g.chart__group', { r: bindReference(refs, 'previewGroup') }, yAxis.map(createPath('previewPath'))]],\n        ],\n        [\n          'div.chart__range',\n          { r: bindReference(refs, 'rangeEl') },\n          [\n            ['div.chart__adjust', { l: { mousedown: beforeAdjust('start'), touchstart: beforeAdjust('start') } }],\n            ['div.chart__handle', { l: { mousedown: beforeAdjust('move'), touchstart: beforeAdjust('move') } }],\n            ['div.chart__adjust', { l: { mousedown: beforeAdjust('width'), touchstart: beforeAdjust('width') } }],\n          ],\n        ],\n      ],\n    ],\n    ['div.chart__controls', {}, yAxis.map(createSwitcher)],\n  ]);\n\n  function createPath(referenceKey) {\n    return function({ d, c }, i) {\n      return create('path.fade', {\n        a: {\n          stroke: c,\n          fill: 'none',\n          'vector-effect': 'non-scaling-stroke',\n          d: d.reduce((a, y, x) => (a += (x === 0 ? 'M' : 'L') + `${x} ${maxY - y}`), ''),\n        },\n        r: bindReference(yAxis[i], referenceKey),\n      });\n    };\n  }\n\n  function createSwitcher({ n, c }, i) {\n    return create(\n      'button.chart__switcher.switcher',\n      {\n        l: { click: toggleLine(yAxis[i]) },\n        r: bindReference(yAxis[i], 'switcher'),\n      },\n      [\n        ['span.switcher__checkbox.muting', { s: { backgroundColor: c } }],\n        ['span.switcher__label', { d: { textContent: n } }],\n      ]\n    );\n  }\n\n  function createDot(flag) {\n    return function({ c }, i) {\n      return create(`path.fade.lens.chart__${flag ? 'dot' : 'pin'}`, {\n        a: {\n          stroke: flag ? c : null,\n          fill: 'none',\n          'vector-effect': 'non-scaling-stroke',\n          d: 'M0 0L0 0.01',\n        },\n        r: bindReference(yAxis[i], flag ? 'dot' : 'pin'),\n      });\n    };\n  }\n\n  function createPathAndDots(referenceKey) {\n    return function(СЃ, i) {\n      return [createPath(referenceKey)(СЃ, i), createDot(true)(СЃ, i), createDot(false)(СЃ, i)];\n    };\n  }\n\n  function createLegendY() {\n    let legend = [];\n    for (let i = 0; i < LEGEND_Y_LINE_COUNT; i++) {\n      legend.unshift(\n        create('div.chart__legend-y-section', {\n          d: { textContent: getLedendY(i) },\n          r: bindReference(refs, `legendY${i}`),\n        })\n      );\n    }\n    return legend;\n  }\n\n  function createLegendX() {\n    const legendX = xAxis.map(date =>\n      create('div.chart__legend-x-section.fade', {}, [\n        ['div.chart__legend-x-label', { d: { textContent: getDateString(date) } }],\n      ])\n    );\n    bindReference(refs, 'legendXLabels', legendX);\n    return legendX;\n  }\n\n  function createTooltipValues({ n, c }, i) {\n    return create('div.tooltip__value.muting', { r: bindReference(yAxis[i], 'tooltipValue'), s: { color: c } }, [\n      ['div.tooltip__number', { r: bindReference(yAxis[i], 'tooltip') }],\n      ['div.tooltip__label', { d: { textContent: n } }],\n    ]);\n  }\n\n  function onResize() {\n    setChartWidthAndOffset();\n    moveLegendX();\n  }\n\n  function setChartWidthAndOffset() {\n    chartWidth = refs.previewEl.offsetWidth;\n    chartOffsetX = refs.previewEl.getBoundingClientRect().x;\n  }\n\n  function beforeAdjust(type) {\n    return function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n      isAdjusting = true;\n      eventType = type;\n      prevX = getEventX(e);\n    };\n  }\n\n  function adjust(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    if (!isAdjusting) {\n      return;\n    }\n    const x = getEventX(e);\n    const delta = (x - prevX) / chartWidth;\n    prevX = x;\n    if (!delta) {\n      return;\n    }\n    const nextStart = start + delta;\n    let nextWidth = width + delta;\n    switch (eventType) {\n      case 'start':\n        nextWidth = width - delta;\n        if (nextStart >= 0) {\n          width = limit(nextWidth, MAX_ZOOM, 1);\n          start = limit(nextStart, 0, 1 - MAX_ZOOM);\n        }\n        break;\n      case 'width':\n        if (nextWidth + start <= 1) {\n          width = limit(nextWidth, MAX_ZOOM, 1);\n        }\n        break;\n      case 'move':\n        if (nextStart + width <= 1) {\n          start = limit(nextStart, 0, 1);\n        }\n        break;\n    }\n    movePreview();\n    drawCharts();\n    moveLegendX();\n    scaleLegendX();\n    drawLegendY(Math.sign(delta));\n  }\n\n  function afterAdjust() {\n    isAdjusting = false;\n  }\n\n  function toggleLine(line) {\n    return function() {\n      const direction = line.a ? 1 : -1;\n      line.a = !line.a;\n      drawLinesAndSwitches();\n      scalePreview();\n      drawCharts();\n      drawLegendY(direction);\n    };\n  }\n\n  function moveLens(e) {\n    e.stopPropagation();\n    const lensX = limit((getEventX(e) - chartOffsetX) / chartWidth, 0, 1);\n    const x = Math.round(getStartIndex() + getViewBoxXRange() * lensX);\n    if (zoomedIndex !== x) {\n      zoomedIndex = x;\n      refs.lensZoom.setAttribute('d', `M${x} 0L${x} ${maxY}`);\n      refs.tooltipDate.textContent = getDateString(xAxis[x], true);\n      const lensPos = (x - getStartIndex()) / getViewBoxXRange() * chartWidth;\n      const tooltipOffset = refs.tooltip.offsetWidth * lensX;\n      refs.tooltip.style.transform = `translateX(${lensPos - tooltipOffset}px)`;\n      yAxis.forEach(({ d, dot, pin, tooltip }) => {\n        const yValue = d[x];\n        const y = maxY - yValue;\n        const dd = `M${x} ${y}L${x} ${y + 0.01}`;\n        dot.setAttribute('d', dd);\n        pin.setAttribute('d', dd);\n        tooltip.textContent = shortNumber(yValue);\n      });\n    }\n  }\n\n  function drawLinesAndSwitches() {\n    yAxis.forEach(({ a, switcher, lensPath, previewPath, dot, pin, tooltipValue }) => {\n      [switcher, lensPath, previewPath, dot, pin, tooltipValue].forEach(el => toggleClass(el, a, 'active'));\n    });\n  }\n\n  function movePreview() {\n    refs.rangeEl.style.left = `${start.toFixed(4) * 100}%`;\n    refs.rangeEl.style.width = `${width.toFixed(4) * 100}%`;\n  }\n\n  function scalePreview() {\n    const transform = `scale(1, ${getPreviewScale().toFixed(2)})`;\n    setTransform(refs.previewGroup, transform);\n  }\n\n  function drawCharts() {\n    const translateX = (-(100 / getViewBoxXRange()) * getStartIndex()).toFixed(2);\n    const scaleX = (xAxisLength / getViewBoxXRange()).toFixed(2);\n    const scaleY = getLensScale().toFixed(2);\n    refs.lensTranslateGroup.style.transform = `translate(${translateX}%, 0)`;\n    setTransform(refs.lensScaleXGroup, `scale(${scaleX}, 1)`);\n    setTransform(refs.lensScaleYGroup, `scale(1, ${scaleY})`);\n  }\n\n  let drawLegendY = debounce(function(direction) {\n    for (let i = 0; i < LEGEND_Y_LINE_COUNT; i++) {\n      refs[`legendY${i}`].textContent = getLedendY(i);\n    }\n  }, 100);\n\n  function moveLegendX() {\n    refs.legendX.style.transform = `translateX(${-start * 100}%)`;\n  }\n\n  let scaleLegendX = debounce (function() {\n    const legendXWidth = ((chartWidth * xAxisLength) / getViewBoxXRange()).toFixed(2);\n    refs.legendX.style.width = `${legendXWidth}px`;\n    const labelsToSkipDivider = Math.ceil(MIN_LEGEND_X_LABEL_WIDHT_PX / (legendXWidth / xAxisLength));\n    refs.legendXLabels.forEach((label, i) => {\n      toggleClass(label, i % labelsToSkipDivider === 0, 'active');\n    });\n  },16)\n\n  // function destroy() {\n  //   document.removeEventListener('mousemove', adjust, false);\n  //   document.removeEventListener('touchmove', adjust, false);\n  //   document.removeEventListener('mouseup', afterAdjust, false);\n  //   document.removeEventListener('touchend', afterAdjust, false);\n  //   window.removeEventListener('resize', onResize, false);\n  //   chartElement.remove();\n  // }\n\n  function init() {\n    setChartWidthAndOffset();\n    movePreview();\n    scalePreview();\n    drawLinesAndSwitches();\n    drawCharts();\n    moveLegendX();\n    scaleLegendX();\n    document.addEventListener('mousemove', adjust, false);\n    document.addEventListener('touchmove', adjust, false);\n    document.addEventListener('mouseup', afterAdjust, false);\n    document.addEventListener('touchend', afterAdjust, false);\n    window.addEventListener('resize', onResize, false);\n  }\n\n  const observer = new MutationObserver(mutationCallback);\n\n  function mutationCallback(mutationsList, observer) {\n    for (var mutation of mutationsList) {\n      if (mutation.type == 'childList') {\n        init();\n        observer.disconnect();\n      }\n    }\n  }\n\n  observer.observe(parentElement, { childList: true });\n\n  currentId++;\n\n  parentElement.appendChild(chartElement);\n  return chartElement;\n}\n\n/* UTILS */\n\nfunction getByFirst(array, key) {\n  return array.find(item => item[0] === key);\n}\n\nfunction create(t, { s, l, a, r, d } = {}, h) {\n  // extract classlist from tag name\n  const [_t, ...c] = t.split('.');\n  // create element by tagName\n  const e =\n    ['svg', 'path', 'g'].indexOf(_t) > -1\n      ? document.createElementNS('http://www.w3.org/2000/svg', _t)\n      : document.createElement(_t);\n  // add classes\n  if (c.length) {\n    c.forEach(i => e.classList.add(i));\n  }\n  // set attributes by key\n  if (a) {\n    for (const k in a) {\n      var attr = a[k];\n      if (attr) {\n        e.setAttribute(k, attr);\n      }\n    }\n  }\n  // assign dom props\n  if (d) {\n    for (const k in d) {\n      e[k] = d[k];\n    }\n  }\n  // assign styles\n  if (s) {\n    for (const k in s) {\n      e.style[k] = s[k];\n    }\n  }\n  // bind listeners\n  if (l) {\n    for (const k in l) {\n      e.addEventListener(k, l[k], false);\n    }\n  }\n  // create childs\n  if (h) {\n    h.forEach(i => (i instanceof Element ? e.appendChild(i) : e.appendChild(create(...i))));\n  }\n  // bind rel\n  if (r) {\n    r(e);\n  }\n  return e;\n}\n\nfunction toggleClass(el, state, className) {\n  if (state) {\n    el.classList.add(className);\n  } else {\n    el.classList.remove(className);\n  }\n}\n\nfunction getEventX(e) {\n  return e.targetTouches ? e.targetTouches[0].clientX : e.clientX;\n}\n\nfunction limit(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction bindReference(target, key, el) {\n  if (!el) {\n    return bindReference.bind(this, target, key);\n  }\n  target[key] = el;\n}\n\nfunction debounce(fn, delay) {\n  let timeoutId;\n  return function() {\n    const args = arguments;\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(function() {\n      timeoutId = null;\n      fn.apply(null, args);\n    }, delay);\n  };\n}\n\nfunction throttle(func, ms) {\n\n  var isThrottled = false,\n    savedArgs,\n    savedThis;\n\n  function wrapper() {\n\n    if (isThrottled) { // (2)\n      savedArgs = arguments;\n      savedThis = this;\n      return;\n    }\n\n    func.apply(this, arguments); // (1)\n\n    isThrottled = true;\n\n    setTimeout(function() {\n      isThrottled = false; // (3)\n      if (savedArgs) {\n        wrapper.apply(savedThis, savedArgs);\n        savedArgs = savedThis = null;\n      }\n    }, ms);\n  }\n\n  return wrapper;\n}\n\nfunction getDateString(date, flag) {\n  const [weekday, month, day] = new Date(date).toString().split(' ');\n  return `${flag ? weekday + ', ' : ''}${month} ${day.replace(/^0/, '')}`;\n}\n\nfunction setTransform(el, transform) {\n  if (isFirefox) {\n    el.setAttribute('transform', transform);\n  } else {\n    el.style.transform = transform;\n  }\n}\n\nfunction shortNumber(number) {\n  if (number > 1e6) {\n    return (number/1e6).toFixed(1) + 'M';\n  }\n  if (number > 1e3) {\n    return (number/1e3).toFixed(1) + 'K';\n  }\n  return number;\n}\n\n/* PERFORMANCE TESTING */\n\nfunction ctt(fn, msg, count = 1) {\n  console.time(msg);\n  for (let c = 0; c < count; c++) {\n    fn();\n  }\n  console.timeEnd(msg);\n}\n\n/* USERCODE */\n\nconst body = document.body;\n\nfetch('/chart_data.json')\n  .then(response => response.json())\n  .then(charts =>\n    charts.forEach(data => {\n      const holder = create('div.holder');\n      console.time('creating');\n      createChart(data, holder);\n      console.timeEnd('creating');\n      body.appendChild(holder);\n    })\n  )\n  .then(() => {\n    body.appendChild(\n      create('button.mode.muting', {\n        d: { textContent: MODE_NAMES.day },\n        l: {\n          click: function(e) {\n            const el = e.target;\n            const isNight = el.textContent === MODE_NAMES.night;\n            el.textContent = isNight ? MODE_NAMES.day : MODE_NAMES.night;\n            toggleClass(document.documentElement, !isNight, 'night-mode');\n          },\n        },\n      })\n    );\n  });\n"]}